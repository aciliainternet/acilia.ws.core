{% extends('@WSCore/cms/layout.html.twig') %}

{% page_configuration {
    'title': 'configure_title'|trans({ '%name%': navigation.name }, 'ws_cms_navigation'),
    'header': 'title'|trans([], 'ws_cms_navigation'),
    'breadcrumbs': [
    {
        'name': 'title'|trans([], 'ws_cms_navigation'),
        'main': false,
        'path': path('ws_navigation_index')
    },
    {
        'name': 'configure_title'|trans({ '%name%': navigation.name }, 'ws_cms_navigation'),
        'main': true
    }
]} %}

{% block content %}
    <div class="row u-mb-large u-ml-30 u-mr-30">
        <div 
            class="col-sm-12"
            data-controller="site-config"
            data-site-config-save-url-value=""
        >
            <div class="c-table-responsive@desktop">
                <div class="c-toolbar c-toolbar--column c-toolbar--caption u-justify-space-between u-mb-20">
                    <div class="c-toolbar__row">
                        <div class="u-flex u-mr-auto">
                            <h4 class="c-toolbar__title u-mr-10 u-pt-10 u-pb-10">
                                {{ 'configure_title'|trans({ '%name%': navigation.name }, 'ws_cms_navigation') }}
                            </h4>

                            <button class="c-btn c-btn--brand js-navigation-new-item-btn">{{ 'new.item'|trans([], 'ws_cms_navigation') }}</button>
                        </div>
                    </div>

                    <div class="c-toolbar_row js-navigation-new-item-form u-hidden">
                        <div class="c-form">
                            {{ form_start(newItemForm, { attr: { action: path('ws_navigation_new_item', { id: navigation.id }) }}) }}
                                {{ form_row(newItemForm.parent) }}
                                {{ form_row(newItemForm.item) }}

                                <button class="c-btn c-btn--primary">{{ 'new.item.save'|trans([], 'ws_cms_navigation') }}</button>
                            {{ form_end(newItemForm) }}
                        </div>
                    </div>
                </div>

                {% if navigation is defined and navigation.menuItems|length > 0 %}
                    <div
                        class="c-table c-table--highlight" style="border-radius: 0"
                        data-controller="item-order"
                    >
                        {% set navigation_tree = cms_get_navigation_tree(navigation) %}
                        
                        {{ dump(navigation_tree) }}
                    </div>
                {% else %}
                    <div class="c-toolbar c-toolbar--caption" style="border-radius: 0; border-bottom: 1px solid #e6eaee;">
                        <div class="c-form__content-full">
                            <p>
                                <i class="fa fa-info-circle u-color-warning"></i> {{ 'empty'|trans([], 'ws_cms_navigation') }}
                            </p>
                        </div>
                    </div>
                {% endif %}
            </div>

            <button
                class="c-btn c-btn--info u-mt-30"
                data-action="click->site-config#onSave"
                data-site-config-target="saveBtn"
            >
                {{ 'save'|trans([], 'ws_cms') }}

                <span class="o-loader-wrapper" data-site-config-target="loader">
                    <span class="o-loader"></span>
                </span>
            </button>

            <a
                class="c-btn c-btn--cancel u-mt-30"
                href="{{ path('ws_navigation_index') }}"
            >{{ 'cancel'|trans([], 'ws_cms') }}</a>
        </div>
    </div>
{% endblock %}
